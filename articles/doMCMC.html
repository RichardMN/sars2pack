<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Building MCMC-based models of SI for SARS-Cov-2 • sars2pack</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Building MCMC-based models of SI for SARS-Cov-2">
<meta property="og:description" content="sars2pack">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sars2pack</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/add_a_dataset.html">How to add a new dataset to sars2pack</a>
    </li>
    <li>
      <a href="../articles/case_tracking.html">Case tracking datasets</a>
    </li>
    <li>
      <a href="../articles/datasets.html">Overview of available datasets</a>
    </li>
    <li>
      <a href="../articles/doMCMC.html">Building MCMC-based models of SI for SARS-Cov-2</a>
    </li>
    <li>
      <a href="../articles/how_much_testing.html">HMTPlot: How much testing</a>
    </li>
    <li>
      <a href="../articles/index.html">Introduction to sars2pack</a>
    </li>
    <li>
      <a href="../articles/map_visualization.html">Geospatial visualization of COVID-19 datasets</a>
    </li>
    <li>
      <a href="../articles/more_visualization.html">Visualizing geographic COVID-19 trends without maps</a>
    </li>
    <li>
      <a href="../articles/overview.html">Exploring the COVID-19 pandemic using sars2pack</a>
    </li>
    <li>
      <a href="../articles/phylogenetics.html">Phylogenetic data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/seandavi/sars2pack">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Building MCMC-based models of SI for SARS-Cov-2</h1>
                        <h4 class="author">Vincent J. Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 class="date">September 29, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/seandavi/sars2pack/blob/master/vignettes/doMCMC.Rmd"><code>vignettes/doMCMC.Rmd</code></a></small>
      <div class="hidden name"><code>doMCMC.Rmd</code></div>

    </div>

    
    
<div id="building-mcmc-based-models-of-si-for-sars-cov-2" class="section level1">
<h1 class="hasAnchor">
<a href="#building-mcmc-based-models-of-si-for-sars-cov-2" class="anchor"></a>Building MCMC-based models of SI for SARS-Cov-2</h1>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>The serial interval is defined as the time elapsed between onset of symptoms in an index case, and onset of symptoms in a secondary case infected through contact with the index case.</p>
<p>The distribution of the serial interval plays a role in modeling time-dependent transmission rates. Specifically, following Cori et al. (2013), the instantaneous reproduction number, that we will denote R[t], is defined as <span class="math display">\[
R[t] = I[t]/\Sigma_{s=1}^t I[t-s]w[s]
\]</span> where <span class="math inline">\(I[t]\)</span> denotes incidence of infection in period <span class="math inline">\(t\)</span> and <span class="math inline">\(w[s]\)</span> is the “infectivity function” which is “approximated by the distribution of the serial interval” (p1506).</p>
</div>
<div id="tables-with-primary-and-secondary-contact-events" class="section level2">
<h2 class="hasAnchor">
<a href="#tables-with-primary-and-secondary-contact-events" class="anchor"></a>Tables with primary and secondary contact events</h2>
<p>This tables are formed to help produce samples from the SI distribution for SARS-Cov-2. The source is <a href="https://wwwnc.cdc.gov/eid/article/26/6/20-0357_article">Du et al. (2020)</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">sars2pack</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">pos_si_93cn</span><span class="op">)</span></pre></div>
<pre><code>## [1] 361   5</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pos_si_93cn</span><span class="op">)</span></pre></div>
<pre><code>##   EL ER SL SR type
## 1 16 16 20 20    2
## 2 16 16 20 20    2
## 3 15 15 21 21    2
## 4 16 16 20 20    2
## 5 14 14 16 16    2
## 6 18 18 22 22    2</code></pre>
<p><code>pos_si_93cn</code> is a subset of 468 records with positive serial interval.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">cens_si_93cn</span><span class="op">)</span></pre></div>
<pre><code>## [1] 468   5</code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">cens_si_93cn</span><span class="op">[</span><span class="fl">10</span><span class="op">:</span><span class="fl">15</span>,<span class="op">]</span></pre></div>
<pre><code>##    EL ER SL SR type
## 10 11 11 19 19    2
## 11 -9 19 20 20    1
## 12 17 17 22 22    2
## 13 21 21 24 24    2
## 14 -6 22 23 23    1
## 15 -8 20 21 21    1</code></pre>
<p><code>cens_si_93cn</code> constitutes a modification to the serial interval data to avoid introducing negative serial intervals, retaining all 468 records. Any record in which the symptom onset of the secondary case is prior to that of the index case is reformulated with the index case time regarded as interval-censored with onset date known only to lie in an interval of length 28 days, ending one day before the onset date reported for the secondary case.</p>
</div>
<div id="mcmc-estimation-of-the-si-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#mcmc-estimation-of-the-si-distribution" class="anchor"></a>MCMC estimation of the SI distribution</h2>
<p>The crucial resource here is the approach to fitting models to (potentially) doubly interval-censored event time data as developed by <a href="http://doi.wiley.com/10.1002/sim.3659">N. Reich et al., Statistics in Medicine 2009</a>.</p>
<div id="using-the-censored-data-representation" class="section level3">
<h3 class="hasAnchor">
<a href="#using-the-censored-data-representation" class="anchor"></a>Using the censored data representation</h3>
<p>These entities were precomputed Apr 24 2020.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=coarseDataTools">coarseDataTools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">EpiEstim</span><span class="op">)</span>
<span class="va">censans_W</span> <span class="op">=</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coarseDataTools/man/dic.fit.mcmc.html">dic.fit.mcmc</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">cens_si_93cn</span>, dist <span class="op">=</span> <span class="st">"W"</span>, optim.method<span class="op">=</span><span class="st">"SANN"</span>,
   seed<span class="op">=</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">si_cens_W</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/coarse2estim.html">coarse2estim</a></span><span class="op">(</span><span class="va">censans_W</span>, thin<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">si_cens_W</span>, file<span class="op">=</span><span class="st">"si_cens_W.rda"</span><span class="op">)</span>
<span class="va">censans_L</span> <span class="op">=</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coarseDataTools/man/dic.fit.mcmc.html">dic.fit.mcmc</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">cens_si_93cn</span>, dist <span class="op">=</span> <span class="st">"L"</span>, optim.method<span class="op">=</span><span class="st">"SANN"</span>,
   seed<span class="op">=</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">si_cens_L</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/coarse2estim.html">coarse2estim</a></span><span class="op">(</span><span class="va">censans_L</span>, thin<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">si_cens_L</span>, file<span class="op">=</span><span class="st">"si_cens_L.rda"</span><span class="op">)</span>
<span class="va">censans_G</span> <span class="op">=</span> <span class="fu">coarseDataTools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coarseDataTools/man/dic.fit.mcmc.html">dic.fit.mcmc</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">cens_si_93cn</span>, dist <span class="op">=</span> <span class="st">"G"</span>, optim.method<span class="op">=</span><span class="st">"SANN"</span>,
   seed<span class="op">=</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">si_cens_G</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/coarse2estim.html">coarse2estim</a></span><span class="op">(</span><span class="va">censans_G</span>, thin<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">si_cens_G</span>, file<span class="op">=</span><span class="st">"si_cens_G.rda"</span><span class="op">)</span></pre></div>
<p>On the left we trace the pointwise means of the posterior distribution of SI(t). On the right we give the posterior density of SI(4) for three parametric models used to form the censored data likelihoods.</p>
<p><img src="doMCMC_files/figure-html/lkpl-1.png" width="672"></p>
</div>
<div id="using-only-positive-values-for-transmission-time" class="section level3">
<h3 class="hasAnchor">
<a href="#using-only-positive-values-for-transmission-time" class="anchor"></a>Using only positive values for transmission time</h3>
<p><img src="doMCMC_files/figure-html/lkpl2-1.png" width="672"></p>
</div>
</div>
<div id="estimating-rt-using-stored-mcmc-based-fits-to-si-data" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-rt-using-stored-mcmc-based-fits-to-si-data" class="anchor"></a>Estimating R[t] using stored MCMC-based fits to SI data</h2>
<div id="using-the-censored-representation-of-si-data" class="section level3">
<h3 class="hasAnchor">
<a href="#using-the-censored-representation-of-si-data" class="anchor"></a>Using the censored representation of SI data</h3>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="op">{</span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="../reference/enriched_jhu_data.html">enriched_jhu_data</a></span><span class="op">(</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></pre></div>
<pre><code>## using temporary cache /tmp/RtmpzyRZWY/BiocFileCache</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="va">cusa</span> <span class="op">=</span> <span class="fu"><a href="../reference/cumulative_events_ejhu.html">cumulative_events_ejhu</a></span><span class="op">(</span><span class="va">dat</span>, eventtype<span class="op">=</span><span class="st">"confirmed"</span>,
      alpha3<span class="op">=</span><span class="st">"USA"</span><span class="op">)</span>
<span class="va">cusa</span></pre></div>
<pre><code>## cumulative event data for USA, 2020-01-22 to 2020-09-27 
## use plot() to visualize.</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="va">iusa</span> <span class="op">=</span> <span class="fu"><a href="../reference/form_incident_events.html">form_incident_events</a></span><span class="op">(</span><span class="fu"><a href="../reference/trim_from.html">trim_from</a></span><span class="op">(</span><span class="va">cusa</span>, <span class="st">"2020-03-10"</span><span class="op">)</span><span class="op">)</span>
<span class="va">iusa2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>I<span class="op">=</span><span class="va">iusa</span><span class="op">$</span><span class="va">count</span>, dates<span class="op">=</span><span class="va">iusa</span><span class="op">$</span><span class="va">dates</span><span class="op">)</span></pre></div>
<div id="weibull" class="section level4">
<h4 class="hasAnchor">
<a href="#weibull" class="anchor"></a>Weibull</h4>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="va">wcens</span> <span class="op">=</span> <span class="fu">EpiEstim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/estimate_R.html">estimate_R</a></span><span class="op">(</span><span class="va">iusa2</span>, method<span class="op">=</span><span class="st">"si_from_sample"</span>, si_sample<span class="op">=</span><span class="va">si_cens_W</span><span class="op">$</span><span class="va">si_sample</span>, 
     config<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/make_config.html">make_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>n2<span class="op">=</span><span class="fl">50</span>, seed<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## Default config will estimate R on weekly sliding windows.
##     To change this change the t_start and t_end arguments.</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="va">nn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/coarseDataTools/man/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">wcens</span><span class="op">)</span></pre></div>
<p><img src="doMCMC_files/figure-html/fit1-1.png" width="700"></p>
</div>
<div id="lognormal" class="section level4">
<h4 class="hasAnchor">
<a href="#lognormal" class="anchor"></a>Lognormal</h4>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="va">lncens</span> <span class="op">=</span> <span class="fu">EpiEstim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/estimate_R.html">estimate_R</a></span><span class="op">(</span><span class="va">iusa2</span>, method<span class="op">=</span><span class="st">"si_from_sample"</span>, si_sample<span class="op">=</span><span class="va">si_cens_L</span><span class="op">$</span><span class="va">si_sample</span>, 
     config<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/make_config.html">make_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>n2<span class="op">=</span><span class="fl">50</span>, seed<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## Default config will estimate R on weekly sliding windows.
##     To change this change the t_start and t_end arguments.</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="va">nn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/coarseDataTools/man/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">lncens</span><span class="op">)</span></pre></div>
<p><img src="doMCMC_files/figure-html/fit2-1.png" width="700"></p>
</div>
<div id="comparing-rt-trajectories-for-weibull-and-lognormal-base-models" class="section level4">
<h4 class="hasAnchor">
<a href="#comparing-rt-trajectories-for-weibull-and-lognormal-base-models" class="anchor"></a>Comparing R[t] trajectories for Weibull and Lognormal base models</h4>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/coarseDataTools/man/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">wcens</span><span class="op">$</span><span class="va">dates</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">]</span>, <span class="va">wcens</span><span class="op">$</span><span class="va">R</span><span class="op">$</span><span class="va">`Mean(R)`</span>, xlab<span class="op">=</span><span class="st">"date"</span>, ylab<span class="op">=</span><span class="st">"R(t)"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lncens</span><span class="op">$</span><span class="va">dates</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">]</span>, <span class="va">lncens</span><span class="op">$</span><span class="va">R</span><span class="op">$</span><span class="va">`Mean(R)`</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Weibull"</span>, <span class="st">"lognormal"</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="doMCMC_files/figure-html/senso-1.png" width="700"></p>
</div>
</div>
<div id="using-the-positive-si-only-representations-and-fits" class="section level3">
<h3 class="hasAnchor">
<a href="#using-the-positive-si-only-representations-and-fits" class="anchor"></a>Using the positive-SI only representations and fits</h3>
<div id="weibull-1" class="section level4">
<h4 class="hasAnchor">
<a href="#weibull-1" class="anchor"></a>Weibull</h4>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="va">wpos</span> <span class="op">=</span> <span class="fu">EpiEstim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/estimate_R.html">estimate_R</a></span><span class="op">(</span><span class="va">iusa2</span>, method<span class="op">=</span><span class="st">"si_from_sample"</span>, si_sample<span class="op">=</span><span class="va">si_pos_W</span><span class="op">$</span><span class="va">si_sample</span>, 
     config<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/make_config.html">make_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>n2<span class="op">=</span><span class="fl">50</span>, seed<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## Default config will estimate R on weekly sliding windows.
##     To change this change the t_start and t_end arguments.</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit">
<span class="va">nn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/coarseDataTools/man/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">wpos</span><span class="op">)</span></pre></div>
<p><img src="doMCMC_files/figure-html/fit1b-1.png" width="700"></p>
</div>
<div id="lognormal-1" class="section level4">
<h4 class="hasAnchor">
<a href="#lognormal-1" class="anchor"></a>Lognormal</h4>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="va">lnpos</span> <span class="op">=</span> <span class="fu">EpiEstim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/estimate_R.html">estimate_R</a></span><span class="op">(</span><span class="va">iusa2</span>, method<span class="op">=</span><span class="st">"si_from_sample"</span>, si_sample<span class="op">=</span><span class="va">si_pos_L</span><span class="op">$</span><span class="va">si_sample</span>, 
     config<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/make_config.html">make_config</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>n2<span class="op">=</span><span class="fl">50</span>, seed<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## Default config will estimate R on weekly sliding windows.
##     To change this change the t_start and t_end arguments.</code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit">
<span class="va">nn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/coarseDataTools/man/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">lnpos</span><span class="op">)</span></pre></div>
<p><img src="doMCMC_files/figure-html/fit2b-1.png" width="700"></p>
</div>
<div id="rt-trajectories-for-weibull-and-lognormal-base-models-censored-and-positive-only" class="section level4">
<h4 class="hasAnchor">
<a href="#rt-trajectories-for-weibull-and-lognormal-base-models-censored-and-positive-only" class="anchor"></a>R[t] trajectories for Weibull and Lognormal base models, censored and positive-only</h4>
<div class="sourceCode" id="cb28"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/coarseDataTools/man/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">wcens</span><span class="op">$</span><span class="va">dates</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">]</span>, <span class="va">wcens</span><span class="op">$</span><span class="va">R</span><span class="op">$</span><span class="va">`Mean(R)`</span>, xlab<span class="op">=</span><span class="st">"date"</span>, ylab<span class="op">=</span><span class="st">"R(t)"</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lncens</span><span class="op">$</span><span class="va">dates</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">]</span>, <span class="va">lncens</span><span class="op">$</span><span class="va">R</span><span class="op">$</span><span class="va">`Mean(R)`</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">wpos</span><span class="op">$</span><span class="va">dates</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">]</span>,<span class="va">wpos</span><span class="op">$</span><span class="va">R</span><span class="op">$</span><span class="va">`Mean(R)`</span>,lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lnpos</span><span class="op">$</span><span class="va">dates</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">]</span>, <span class="va">lnpos</span><span class="op">$</span><span class="va">R</span><span class="op">$</span><span class="va">`Mean(R)`</span>,lty<span class="op">=</span><span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Weibull"</span>, <span class="st">"lognormal"</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="doMCMC_files/figure-html/sensocomp-1.png" width="700"></p>
<p>We conclude that the difference between excluding negative SI reports and censoring the infector times is very small. Further work is needed to employ all the information (i.e., the negative SI values) provided in the Du et al. CDC report.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sean Davis, VJ Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
